@{
    <style>
        body,
        html,
        #container {
            margin: 0;
            width: 100%;
            height: 100%;
            font-family: "微软雅黑";
        }

        .info {
            z-index: 999;
            width: auto;
            min-width: 22rem;
            padding: .75rem 1.25rem;
            margin-left: 1.25rem;
            position: fixed;
            top: 1rem;
            background-color: #fff;
            border-radius: .25rem;
            font-size: 14px;
            color: #666;
            box-shadow: 0 2px 6px 0 rgba(27, 142, 236, 0.5);
        }

        ul li {
            list-style: none;
        }

        .drawing-panel {
            z-index: 999;
            position: fixed;
            bottom: 3.5rem;
            margin-left: 2.5rem;
            padding-left: 0;
            border-radius: .25rem;
            height: 47px;
            box-shadow: 0 2px 6px 0 rgba(27, 142, 236, 0.5);
        }

        .bmap-btn {
            border-right: 1px solid #d2d2d2;
            float: left;
            width: 64px;
            height: 100%;
            background-image: url(//api.map.baidu.com/library/DrawingManager/1.4/src/bg_drawing_tool.png);
            cursor: pointer;
        }

        .drawing-panel .bmap-marker {
            background-position: -65px 0;
        }

        .drawing-panel .bmap-polyline {
            background-position: -195px 0;
        }

        .drawing-panel .bmap-rectangle {
            background-position: -325px 0;
        }

        .drawing-panel .bmap-polygon {
            background-position: -260px 0;
        }

        .drawing-panel .bmap-circle {
            background-position: -130px 0;
        }
    </style>
    <script src="https://api.map.baidu.com/api?type=webgl&v=1.0&ak=Tu9n8fQa4H1Pwsj8I856eoPxvxGE0IHP"></script>
    <!--加载鼠标绘制工具-->
    <script type="text/javascript" src="//mapopen.cdn.bcebos.com/github/BMapGLLib/DrawingManager/src/DrawingManager.min.js"></script>
    <!--加载鼠标绘制工具-->
    <link href="//mapopen.cdn.bcebos.com/github/BMapGLLib/DrawingManager/src/DrawingManager.min.css" rel="stylesheet">
    <!--鼠标测距工具-->
    <script type="text/javascript" src="//mapopen.cdn.bcebos.com/github/BMapGLLib/DistanceTool/src/DistanceTool.min.js"></script>
    <!--路书工具-->
    <script type="text/javascript" src="//bj.bcebos.com/v1/mapopen/github/BMapGLLib/Lushu/src/Lushu.min.js"></script>
    <ul class="drawing-panel">
        <li class="bmap-btn bmap-marker" id="marker" onclick="draw(this)"></li>
        <li class="bmap-btn bmap-polyline" id="polyline" onclick="draw(this)"></li>
        <li class="bmap-btn bmap-rectangle" id="rectangle" onclick="draw(this)"></li>
        <li class="bmap-btn bmap-polygon" id="polygon" onclick="draw(this)"></li>
        <li class="bmap-btn bmap-circle" id="circle" onclick="draw(this)"></li>
    </ul>
    <div>
        <div id="container"></div>
        <button id="run">开始</button>
        <button id="stop">停止</button>
        <button id="pause">暂停</button>
        <button id="hide">隐藏信息窗口</button>
        <button id="show">展示信息窗口</button>
    </div>
    <script>
        // 禁止地图旋转和倾斜可以通过配置项进行设置
        var map = new BMapGL.Map("container",
            {
                enableRotate: false,
                enableTilt: false
            }); // 创建地图实例
        var point = new BMapGL.Point(116.404, 39.915);  // 创建点坐标
        map.centerAndZoom(point, 15);                 // 初始化地图，设置中心点坐标和地图级别
        map.enableScrollWheelZoom(true);     //开启鼠标滚轮缩放
        map.setHeading(64.5);   //设置地图旋转角度
        map.setTilt(73);       //设置地图的倾斜角度
        var scaleCtrl = new BMapGL.ScaleControl();  // 添加比例尺控件
        map.addControl(scaleCtrl);
        var zoomCtrl = new BMapGL.ZoomControl();  // 添加缩放控件
        map.addControl(zoomCtrl);
        // 创建定位控件
        var locationControl = new BMapGL.LocationControl({
            // 控件的停靠位置（可选，默认左上角）
            anchor: BMAP_ANCHOR_TOP_RIGHT,
            // 控件基于停靠位置的偏移量（可选）
            offset: new BMapGL.Size(20, 20)
        });
        // 将控件添加到地图上
        map.addControl(locationControl);

        // 添加定位事件
        locationControl.addEventListener("locationSuccess", function (e) {
            var address = '';
            address += e.addressComponent.province;
            address += e.addressComponent.city;
            address += e.addressComponent.district;
            address += e.addressComponent.street;
            address += e.addressComponent.streetNumber;
            alert("当前定位地址为：" + address);
        });
        locationControl.addEventListener("locationError", function (e) {
            alert(e.message);
        });
        // 创建城市选择控件
        var cityControl = new BMapGL.CityListControl({
            // 控件的停靠位置（可选，默认左上角）
            anchor: BMAP_ANCHOR_TOP_LEFT,
            // 控件基于停靠位置的偏移量（可选）
            offset: new BMapGL.Size(10, 5)
        });

        // 将控件添加到地图上
        map.addControl(cityControl);

        // 开启鼠标滚轮缩放

        var styleOptions = {
            strokeColor: '#5E87DB',   // 边线颜色
            fillColor: '#5E87DB',     // 填充颜色。当参数为空时，圆形没有填充颜色
            strokeWeight: 2,          // 边线宽度，以像素为单位
            strokeOpacity: 1,         // 边线透明度，取值范围0-1
            fillOpacity: 0.2          // 填充透明度，取值范围0-1
        };
        var labelOptions = {
            borderRadius: '2px',
            background: '#FFFBCC',
            border: '1px solid #E1E1E1',
            color: '#703A04',
            fontSize: '12px',
            letterSpacing: '0',
            padding: '5px'
        };

        // 实例化鼠标绘制工具
        var drawingManager = new BMapGLLib.DrawingManager(map, {
            // isOpen: true,        // 是否开启绘制模式
            enableCalculate: false, // 绘制是否进行测距测面
            enableSorption: true,   // 是否开启边界吸附功能
            sorptiondistance: 20,   // 边界吸附距离
            circleOptions: styleOptions,     // 圆的样式
            polylineOptions: styleOptions,   // 线的样式
            polygonOptions: styleOptions,    // 多边形的样式
            rectangleOptions: styleOptions,  // 矩形的样式
            labelOptions: labelOptions,      // label样式
        });

        function draw(e) {
            var arr = document.getElementsByClassName('bmap-btn');
            for (var i = 0; i < arr.length; i++) {
                arr[i].style.backgroundPositionY = '0';
            }
            e.style.backgroundPositionY = '-52px';
            switch (e.id) {
                case 'marker': {
                    var drawingType = BMAP_DRAWING_MARKER;
                    break;
                }
                case 'polyline': {
                    var drawingType = BMAP_DRAWING_POLYLINE;
                    break;
                }
                case 'rectangle': {
                    var drawingType = BMAP_DRAWING_RECTANGLE;
                    break;
                }
                case 'polygon': {
                    var drawingType = BMAP_DRAWING_POLYGON;
                    break;
                }
                case 'circle': {
                    var drawingType = BMAP_DRAWING_CIRCLE;
                    break;
                }
            }
            // 进行绘制
            if (drawingManager._isOpen && drawingManager.getDrawingMode() === drawingType) {
                drawingManager.close();
            } else {
                drawingManager.setDrawingMode(drawingType);
                drawingManager.open();
            }
        };
        // 监听测距过程中的鼠标事件
        map.addEventListener('drawend', function (e) {
            console.log("drawend");
            console.log(e.points);
            console.log(e.overlays);
            console.log(e.distance);
        });
        map.addEventListener("addpoint", function (e) {
            console.log("addpoint");
            console.log(e.point);
            console.log(e.pixel);
            console.log(e.index);
            console.log(e.distance);
        });
        map.addEventListener("removepolyline", function (e) {
            console.log("removepolyline");
            console.log(e);
        });

        var lushu;
        // 实例化一个驾车导航用来生成路线
        var drv = new BMapGL.DrivingRoute('北京', {
            onSearchComplete: function (res) {
                if (drv.getStatus() == BMAP_STATUS_SUCCESS) {
                    var plan = res.getPlan(0);
                    var arrPois = [];
                    for (var j = 0; j < plan.getNumRoutes(); j++) {
                        var route = plan.getRoute(j);
                        arrPois = arrPois.concat(route.getPath());
                    }
                    map.addOverlay(new BMapGL.Polyline(arrPois, { strokeColor: '#111' }));
                    map.setViewport(arrPois);
                    //飞机图片
                    var fly = 'data:image/png;base64,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';
                    lushu = new BMapGLLib.LuShu(map, arrPois, {
                        defaultContent: '起飞啦', // "信息窗口文案"
                        autoView: true, // 是否开启自动视野调整，如果开启那么路书在运动过程中会根据视野自动调整
                        speed: 500,
                        // icon: new BMapGL.Icon('./images/car.png', new BMapGL.Size(32, 32), { anchor: new BMapGL.Size(10, 10) }),
                        icon: new BMapGL.Icon(fly, new BMapGL.Size(48, 48), { anchor: new BMapGL.Size(24, 24) }),
                        enableRotation: true, // 是否设置marker随着道路的走向进行旋转
                    });
                }
            }
        });
        var start = new BMapGL.Point(116.404844, 40);
        var end = new BMapGL.Point(116.308102, 40.056057);
        drv.search(start, end);

        //绑定事件
        $("run").onclick = function () {
            //开始
            lushu.start();
        }
        $("stop").onclick = function () {
            //停止
            lushu.stop();
        }
        $("pause").onclick = function () {
            //暂停
            lushu.pause();
        }
        $("hide").onclick = function () {
            //隐藏信息窗口
            lushu.hideInfoWindow();
        }
        $("show").onclick = function () {
            //展示信息窗口
            lushu.showInfoWindow();
        }
        function $(element) {
            return document.getElementById(element);
        }
    </script>
}
